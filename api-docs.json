{"openapi":"3.0.1","info":{"title":"Demo 後台管理 API","description":"這是後臺管理糸統的 API 文件","version":"21.0"},"servers":[{"url":"http://localhost:8080","description":"Generated server url"}],"tags":[{"name":"角色權限管理","description":"動態訪問權限更改"},{"name":"用戶管理","description":"處理用戶的增刪查改"},{"name":"角色管理","description":"角色的增查改刪"},{"name":"書籍管理","description":"處理書籍的增刪查改"}],"paths":{"/api/users/{id}":{"get":{"tags":["用戶管理"],"summary":"查詢單個用戶","operationId":"getUserById","parameters":[{"name":"id","in":"path","description":"用戶ID","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}}},"security":[{"bearerAuth":[]}]},"put":{"tags":["用戶管理"],"summary":"更新用戶資料","operationId":"updateUser","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateUserRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}}},"security":[{"bearerAuth":[]}]},"delete":{"tags":["用戶管理"],"summary":"刪除用戶","operationId":"deleteUser","parameters":[{"name":"id","in":"path","description":"用戶ID","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK"}},"security":[{"bearerAuth":[]}]}},"/api/roles/{id}":{"get":{"tags":["角色管理"],"summary":"查詢一個角色","operationId":"getRoleById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RoleDto"}}}}},"security":[{"bearerAuth":[]}]},"put":{"tags":["角色管理"],"summary":"更新角色","operationId":"updateRole","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoleCreateRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RoleDto"}}}}},"security":[{"bearerAuth":[]}]},"delete":{"tags":["角色管理"],"summary":"刪除角色","operationId":"deleteRole","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK"}},"security":[{"bearerAuth":[]}]}},"/api/roles/mappings/{id}":{"put":{"tags":["角色權限管理"],"summary":"更新角色訪問權限","operationId":"update","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UrlRoleMapping"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UrlRoleMapping"}}}}},"security":[{"bearerAuth":[]}]},"delete":{"tags":["角色權限管理"],"summary":"刪除角色訪問權限","operationId":"delete","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK"}},"security":[{"bearerAuth":[]}]}},"/api/books":{"get":{"tags":["書籍管理"],"summary":"查詢所有書","operationId":"getAll_1","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/BookDto"}}}}}},"security":[{"bearerAuth":[]}]},"put":{"tags":["書籍管理"],"summary":"更新一本書","operationId":"update_1","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookUpdateRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookDto"}}}}},"security":[{"bearerAuth":[]}]},"post":{"tags":["書籍管理"],"summary":"新增一本書","operationId":"create","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookCreateRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookDto"}}}}},"security":[{"bearerAuth":[]}]}},"/api/users":{"get":{"tags":["用戶管理"],"summary":"查詢所有用戶","operationId":"getAllUsers","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserResponse"}}}}}},"security":[{"bearerAuth":[]}]},"post":{"tags":["用戶管理"],"summary":"新增用戶","operationId":"createUser","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/roles":{"get":{"tags":["角色管理"],"summary":"查詢所有角色","operationId":"getAllRoles","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/RoleDto"}}}}}},"security":[{"bearerAuth":[]}]},"post":{"tags":["角色管理"],"summary":"新增角色","operationId":"createRole","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoleCreateRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RoleDto"}}}}},"security":[{"bearerAuth":[]}]}},"/api/roles/mappings":{"get":{"tags":["角色權限管理"],"summary":"查詢所有角色訪問權限","operationId":"getAll","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UrlRoleMapping"}}}}}},"security":[{"bearerAuth":[]}]},"post":{"tags":["角色權限管理"],"summary":"新增角色訪問權限","operationId":"save","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UrlRoleMapping"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UrlRoleMapping"}}}}},"security":[{"bearerAuth":[]}]}},"/api/auth/reset-password":{"post":{"tags":["入口"],"summary":"重設密碼","operationId":"resetPassword","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/auth/register":{"post":{"tags":["入口"],"summary":"註冊新用戶","operationId":"register","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/auth/login":{"post":{"tags":["入口"],"summary":"登入取得token","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/users/{id}/roles":{"get":{"tags":["用戶管理"],"summary":"取得用戶的角色字串","operationId":"getRolesByIdToString","parameters":[{"name":"id","in":"path","description":"用戶ID","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}},"security":[{"bearerAuth":[]}]}},"/api/users/search":{"get":{"tags":["用戶管理"],"summary":"依帳號關鍵字搜尋用戶","operationId":"searchUsers","parameters":[{"name":"keyword","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/User"}}}}}},"security":[{"bearerAuth":[]}]}},"/api/users/active":{"get":{"tags":["用戶管理"],"summary":"查詢所有啟用中的用戶","operationId":"getAllActiveUsers","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/User"}}}}}},"security":[{"bearerAuth":[]}]}},"/api/roles/mappings/public":{"get":{"tags":["角色權限管理"],"summary":"公開版角色規則（前端選單用）","operationId":"getPublicMappings","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PublicRoleMappingDTO"}}}}}},"security":[{"bearerAuth":[]}]}},"/api/books/{id}":{"get":{"tags":["書籍管理"],"summary":"查詢一本書","operationId":"getOne","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BookDto"}}}}},"security":[{"bearerAuth":[]}]},"delete":{"tags":["書籍管理"],"summary":"刪除一本書","operationId":"delete_1","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK"}},"security":[{"bearerAuth":[]}]}},"/api/auth/refresh-token":{"get":{"tags":["入口"],"summary":"重新簽發 Token","operationId":"refreshToken","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}},"security":[{"bearerAuth":[]}]}},"/api/auth/check":{"get":{"tags":["入口"],"summary":"驗證登入狀態","operationId":"checkToken","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}},"security":[{"bearerAuth":[]}]}}},"components":{"schemas":{"UpdateUserRequest":{"type":"object","properties":{"username":{"type":"string","description":"暱稱","example":"Jerry"},"fullName":{"type":"string","description":"全名","example":"Jerry Chen"},"phone":{"type":"string","description":"電話","example":"0912345678"},"email":{"type":"string","description":"電子郵件","example":"jerry@example.com"},"enabled":{"type":"boolean","description":"是否啟用","example":true},"roleIds":{"uniqueItems":true,"type":"array","description":"角色 ID 列表","example":[1,2],"items":{"type":"integer","description":"角色 ID 列表","format":"int32"}}},"description":"用戶更新請求資料"},"UserResponse":{"type":"object","properties":{"id":{"type":"integer","format":"int32"},"username":{"type":"string"},"fullName":{"type":"string"},"phone":{"type":"string"},"email":{"type":"string"},"enabled":{"type":"boolean"},"roles":{"uniqueItems":true,"type":"array","items":{"type":"string"}}}},"RoleCreateRequest":{"type":"object","properties":{"name":{"type":"string","description":"角色名稱","example":"ROLE_STAFF"}},"description":"建立或更新角色請求"},"RoleDto":{"type":"object","properties":{"id":{"type":"integer","description":"角色 ID","format":"int32","example":1},"name":{"type":"string","description":"角色名稱","example":"ROLE_ADMIN"}},"description":"角色資料"},"UrlRoleMapping":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"urlPattern":{"type":"string"},"roles":{"type":"string"}}},"BookUpdateRequest":{"type":"object","properties":{"id":{"type":"integer","format":"int32"},"title":{"type":"string"},"author":{"type":"string"},"description":{"type":"string"},"listPrice":{"type":"number"},"salePrice":{"type":"number"}}},"BookDto":{"type":"object","properties":{"id":{"type":"integer","format":"int32"},"title":{"type":"string"},"author":{"type":"string"},"description":{"type":"string"},"listPrice":{"type":"number"},"salePrice":{"type":"number"}}},"CreateUserRequest":{"type":"object","properties":{"username":{"type":"string","description":"用戶名稱","example":"jerry"},"password":{"type":"string","description":"密碼","example":"123456"},"fullName":{"type":"string","description":"全名","example":"Jerry Chen"},"phone":{"type":"string","description":"電話","example":"0912345678"},"email":{"type":"string","description":"電子郵件","example":"jerry@example.com"},"enabled":{"type":"boolean","description":"是否啟用","example":true},"roleIds":{"uniqueItems":true,"type":"array","description":"角色 ID 列表","example":[1,2],"items":{"type":"integer","description":"角色 ID 列表","format":"int32"}}},"description":"用戶新增請求資料"},"BookCreateRequest":{"type":"object","properties":{"title":{"type":"string"},"author":{"type":"string"},"description":{"type":"string"},"listPrice":{"type":"number"},"salePrice":{"type":"number"}}},"ResetPasswordRequest":{"type":"object","properties":{"username":{"type":"string","description":"用戶名","example":"staff01"},"newPassword":{"type":"string","description":"新密碼","example":"newPassword123"}},"description":"重設密碼請求"},"RegisterRequest":{"type":"object","properties":{"username":{"type":"string","description":"用戶名","example":"staff01"},"password":{"type":"string","description":"密碼","example":"123456"},"fullName":{"type":"string","description":"姓名","example":"ANDY NOODLE"},"email":{"type":"string","description":"Email","example":"staff01@example.com"},"phone":{"type":"string","description":"電話","example":"0912345678"}},"description":"註冊新用戶請求"},"AuthRequest":{"type":"object","properties":{"username":{"type":"string","description":"用戶名","example":"admin"},"password":{"type":"string","description":"密碼","example":"123456"}},"description":"登入請求"},"GrantedAuthority":{"type":"object","properties":{"authority":{"type":"string"}}},"Role":{"type":"object","properties":{"id":{"type":"integer","format":"int32"},"name":{"type":"string"}}},"User":{"type":"object","properties":{"id":{"type":"integer","format":"int32"},"username":{"type":"string"},"password":{"type":"string"},"fullName":{"type":"string"},"phone":{"type":"string"},"email":{"type":"string"},"enabled":{"type":"boolean"},"roles":{"uniqueItems":true,"type":"array","items":{"$ref":"#/components/schemas/Role"}},"accountNonLocked":{"type":"boolean"},"authorities":{"type":"array","items":{"$ref":"#/components/schemas/GrantedAuthority"}},"accountNonExpired":{"type":"boolean"},"credentialsNonExpired":{"type":"boolean"}}},"PublicRoleMappingDTO":{"type":"object","properties":{"urlPattern":{"type":"string"},"roles":{"type":"string"}}}},"securitySchemes":{"bearerAuth":{"type":"http","in":"header","scheme":"bearer","bearerFormat":"JWT"}}}}